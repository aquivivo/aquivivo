<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Mensajes | AquiVivo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800;900&family=Playfair+Display:wght@700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/styles.css?v=20260208m" />
    <script src="assets/js/layout.js?v=20260208m" type="module"></script>
  </head>

  <body data-page="mensajes">
    <div id="appHeader"></div>

    <main class="page messages-page">
      <div class="container messages-shell">
        <aside class="card messages-sidebar">
          <div class="messages-sidebar-head">
            <div class="sectionTitle" style="margin: 0">Mensajes</div>
            <button class="btn-yellow" id="btnNewChat" type="button">Nuevo chat</button>
          </div>

          <div class="messages-tabs" role="tablist" aria-label="Secciones">
            <button class="messages-tab is-active" data-tab="chats" type="button">Chats</button>
            <button class="messages-tab" data-tab="groups" type="button">Grupos</button>
            <button class="messages-tab" data-tab="support" id="tabSupport" type="button" hidden>
              Soporte
            </button>
          </div>

          <div class="messages-search">
            <input
              class="input"
              id="messagesSearch"
              type="text"
              placeholder="Buscar conversaciones..."
            />
          </div>

          <div class="messages-list" id="chatList"></div>
          <div class="messages-list is-hidden" id="groupList"></div>
          <div class="messages-list is-hidden" id="supportList"></div>

          <div class="messages-sidebar-actions">
            <button class="btn-white-outline" id="btnNewGroup" type="button">Crear grupo</button>
            <button class="btn-white-outline" id="btnOpenSupport" type="button">Soporte</button>
          </div>

          <div class="messages-sidebar-toggles">
            <label class="toggle-line">
              <input type="checkbox" id="toggleArchived" />
              <span>Ver archivados</span>
            </label>
            <label class="toggle-line">
              <input type="checkbox" id="togglePush" />
              <span>Push activo</span>
            </label>
          </div>

          <div class="messages-admin card" id="supportAdminBox" hidden>
            <div class="sectionTitle" style="margin-top: 0">Agentes de soporte</div>
            <div class="hintSmall">Agrega usuarios sin rol admin.</div>
            <div class="metaRow" style="margin-top: 10px">
              <input
                class="input"
                id="supportAgentInput"
                type="text"
                placeholder="@usuario o UID"
              />
              <button class="btn-white-outline" id="btnAddSupportAgent" type="button">
                Agregar
              </button>
            </div>
            <div class="support-agent-list" id="supportAgentList"></div>

            <div class="sectionTitle" style="margin-top: 16px">Reportes</div>
            <div class="reports-list" id="reportsList"></div>
          </div>
        </aside>

        <section class="card messages-main">
          <div class="messages-empty" id="messagesEmpty">
            Selecciona una conversacion o crea un nuevo chat.
          </div>

          <div class="messages-thread" id="messagesThread" hidden>
            <div class="thread-head">
              <div class="thread-title">
                <div class="thread-avatar" id="threadAvatar">AV</div>
                <div>
                  <div class="thread-name" id="threadName">Conversacion</div>
                  <div class="thread-meta" id="threadMeta"></div>
                  <div class="thread-status" id="threadStatus"></div>
                  <div class="thread-typing" id="threadTyping"></div>
                </div>
              </div>
              <div class="thread-actions">
                <button class="btn-white-outline" id="btnJoinGroup" type="button" hidden>
                  Unirme
                </button>
                <button class="btn-white-outline" id="btnLeaveGroup" type="button" hidden>
                  Salir
                </button>
              </div>
            </div>

            <div class="thread-tools">
              <input
                class="input"
                id="threadSearch"
                type="text"
                placeholder="Buscar en este chat..."
              />
              <label class="toggle-line">
                <input type="checkbox" id="threadSearchAttachments" />
                <span>Solo adjuntos</span>
              </label>
              <div class="thread-filter-info" id="threadFilterInfo"></div>
            </div>

            <div class="thread-messages" id="threadMessages"></div>

            <div class="thread-composer">
              <div class="composer-edit" id="composerEdit" hidden>
                <div class="composer-edit-text" id="composerEditText"></div>
                <button class="btn-white-outline" id="btnCancelEdit" type="button">
                  Cancelar edicion
                </button>
              </div>
              <div class="composer-reply" id="composerReply" hidden>
                <div class="composer-reply-text" id="composerReplyText"></div>
                <button class="btn-white-outline" id="btnCancelReply" type="button">
                  Cancelar respuesta
                </button>
              </div>
              <div class="composer-tools">
                <label class="composer-btn">
                  Adjuntos
                  <input id="fileInput" type="file" multiple />
                </label>
                <button class="composer-btn" id="btnRecord" type="button">Voz</button>
                <div class="composer-hint" id="recordHint"></div>
              </div>
              <div class="composer-preview" id="attachmentsPreview"></div>
              <div class="composer-row">
                <textarea
                  id="messageInput"
                  rows="2"
                  placeholder="Escribe un mensaje..."
                ></textarea>
                <button class="btn-yellow" id="btnSend" type="button">Enviar</button>
              </div>
            </div>
          </div>
        </section>

        <aside class="card messages-info" id="messagesInfo" hidden>
          <div class="sectionTitle" style="margin-top: 0">Detalles</div>
          <div class="info-body" id="infoBody"></div>
          <div class="info-actions" id="infoActions"></div>
          <div class="pinned-box" id="pinnedBox"></div>
          <div class="participants-box" id="participantsBox"></div>
          <div class="requests-box" id="requestsBox"></div>
        </aside>
      </div>
    </main>

    <div class="modalOverlay" id="modalNewChat">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Nuevo chat</div>
          <button class="btn-white-outline" id="closeNewChat" type="button">Cerrar</button>
        </div>
        <div class="modalBody">
          <div class="info-field">
            <label for="newChatInput">Buscar usuario</label>
            <input
              id="newChatInput"
              class="input"
              type="text"
              placeholder="@usuario o nombre"
            />
          </div>
          <div class="metaRow" style="margin-top: 10px">
            <button class="btn-yellow" id="btnSearchUser" type="button">Buscar</button>
            <span class="hintSmall" id="newChatHint"></span>
          </div>
          <div class="messages-list" id="newChatResults" style="margin-top: 12px"></div>
        </div>
      </div>
    </div>

    <div class="modalOverlay" id="modalNewGroup">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Crear grupo</div>
          <button class="btn-white-outline" id="closeNewGroup" type="button">Cerrar</button>
        </div>
        <div class="modalBody">
          <div class="info-field">
            <label for="groupName">Nombre del grupo</label>
            <input id="groupName" class="input" type="text" placeholder="Nombre" />
          </div>
          <div class="info-field" style="margin-top: 10px">
            <label for="groupDesc">Descripcion</label>
            <textarea id="groupDesc" class="input" rows="3" placeholder="Opcional"></textarea>
          </div>
          <div class="info-grid" style="margin-top: 10px">
            <div class="info-field">
              <label for="groupPublic">Visibilidad</label>
              <select id="groupPublic" class="select">
                <option value="public">Publico</option>
                <option value="private">Privado</option>
              </select>
            </div>
            <div class="info-field">
              <label for="groupJoinMode">Ingreso</label>
              <select id="groupJoinMode" class="select">
                <option value="open">Abierto</option>
                <option value="approval">Con aprobacion</option>
              </select>
            </div>
          </div>
          <div class="metaRow" style="margin-top: 12px">
            <button class="btn-yellow" id="btnCreateGroup" type="button">Crear</button>
            <span class="hintSmall" id="newGroupHint"></span>
          </div>
        </div>
      </div>
    </div>

    <div class="modalOverlay" id="modalReport">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Reportar</div>
          <button class="btn-white-outline" id="closeReport" type="button">Cerrar</button>
        </div>
        <div class="modalBody">
          <div class="info-field">
            <label for="reportReason">Motivo</label>
            <select id="reportReason" class="select">
              <option value="spam">Spam</option>
              <option value="abuse">Abuso</option>
              <option value="scam">Estafa</option>
              <option value="other">Otro</option>
            </select>
          </div>
          <div class="info-field" style="margin-top: 10px">
            <label for="reportDetails">Detalles</label>
            <textarea id="reportDetails" class="input" rows="3" placeholder="Opcional"></textarea>
          </div>
          <div class="metaRow" style="margin-top: 12px">
            <button class="btn-yellow" id="btnSubmitReport" type="button">Enviar reporte</button>
            <span class="hintSmall" id="reportHint"></span>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="assets/js/pages/mensajes-page.js"></script>
  </body>
</html>




