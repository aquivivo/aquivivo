<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Mensajes | AquiVivo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800;900&family=Playfair+Display:wght@700;900&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/styles.css?v=20260222f" />
    <script src="assets/js/layout.js?v=20260222g" type="module"></script>
  </head>

  <body data-page="mensajes">
    <div id="appHeader"></div>

    <main class="page messages-page messages-page--minimal">
      <div class="container messages-layout">
        <aside class="card messages-sidebar">
          <header class="messages-sidebar-top">
            <div class="messages-sidebar-title">
              <div class="sectionTitle" style="margin: 0">Wiadomosci</div>
              <div class="hintSmall">Szybki podglad i odpowiedzi</div>
            </div>

            <div class="messages-top-actions">
              <button class="btn-yellow" id="btnNewChat" type="button">+ Nuevo</button>
              <details class="messages-settings-menu">
                <summary aria-label="Opciones">‚ãØ</summary>
                <div class="messages-settings-panel">
                  <button class="btn-white-outline" id="btnNewGroup" type="button">Nuevo grupo</button>
                  <button class="btn-white-outline" id="btnOpenSupport" type="button">Soporte</button>
                  <label class="toggle-line">
                    <input type="checkbox" id="toggleArchived" />
                    <span>Archivados</span>
                  </label>
                  <label class="toggle-line">
                    <input type="checkbox" id="togglePush" />
                    <span>Push</span>
                  </label>
                </div>
              </details>
            </div>
          </header>

          <nav class="messages-filters" id="messagesFilters" aria-label="Filtros">
            <button class="messages-filter-tab is-active" id="filterAllChats" data-tab="chats" data-mode="all" type="button">
              Todos
            </button>
            <button class="messages-filter-tab" id="filterUnreadChats" data-tab="chats" data-mode="unread" type="button">
              No leidos
            </button>
            <button class="messages-filter-tab" id="filterGroupsChats" data-tab="groups" type="button">
              Grupos
            </button>
            <button class="messages-filter-tab" id="tabSupport" data-tab="support" type="button" hidden>
              Support
            </button>
          </nav>

          <div class="messages-search">
            <input class="input" id="messagesSearch" type="text" placeholder="Buscar conversacion..." />
          </div>

          <div class="messages-list-head">
            <div class="messages-list-title" id="messagesListTitle">Chats</div>
            <div class="messages-list-count" id="messagesListCount">0</div>
          </div>

          <div class="messages-list-wrap">
            <div class="messages-list" id="chatList"></div>
            <div class="messages-list is-hidden" id="groupList"></div>
            <div class="messages-list is-hidden" id="supportList"></div>
          </div>

          <div class="messages-stats" id="messagesStats" aria-hidden="true">
            <div class="messages-stat-pill">
              <span class="messages-stat-label">Total</span>
              <span class="messages-stat-value" id="messagesTotalCount">0</span>
            </div>
            <div class="messages-stat-pill">
              <span class="messages-stat-label">No leidos</span>
              <span class="messages-stat-value" id="messagesUnreadCount">0</span>
            </div>
          </div>

          <details class="messages-mini-section" id="messagesInboxWrap">
            <summary>Novedades del equipo</summary>
            <div class="inboxList" id="messagesInboxList"></div>
          </details>

          <details class="messages-mini-section" id="messagesAdminWrap" hidden>
            <summary>Admin soporte</summary>
            <div class="messages-admin" id="supportAdminBox" hidden>
              <div class="hintSmall">Agentes de soporte</div>
              <div class="metaRow" style="margin-top: 10px">
                <input class="input" id="supportAgentInput" type="text" placeholder="@usuario o UID" />
                <button class="btn-white-outline" id="btnAddSupportAgent" type="button">Agregar</button>
              </div>
              <div class="support-agent-list" id="supportAgentList"></div>
              <div class="reports-list" id="reportsList"></div>
            </div>
          </details>
        </aside>

        <section class="card messages-main">
          <div class="messages-empty" id="messagesEmpty">
            <div class="messages-empty-title">Selecciona una conversacion</div>
            <div class="messages-empty-subtitle">Elige un chat de la lista para empezar.</div>
          </div>

          <div class="messages-thread" id="messagesThread" hidden>
            <header class="thread-head">
              <div class="thread-title-wrap">
                <button class="thread-back" id="btnBackToInbox" type="button" aria-label="Volver">‚Üê</button>
                <div class="thread-title">
                  <div class="thread-avatar" id="threadAvatar">AV</div>
                  <div class="thread-title-meta">
                    <div class="thread-name" id="threadName">Conversacion</div>
                    <div class="thread-meta" id="threadMeta"></div>
                    <div class="thread-status" id="threadStatus"></div>
                    <div class="thread-typing" id="threadTyping"></div>
                  </div>
                </div>
              </div>

              <div class="thread-actions">
                <button class="thread-icon-btn" id="btnThreadSearch" type="button" aria-label="Buscar">üîç</button>
                <label class="thread-icon-btn" for="fileInput" aria-label="Adjuntar">üìé</label>
                <button class="thread-icon-btn" id="btnToggleInfo" type="button" aria-label="Detalles">‚ÑπÔ∏è</button>
                <button class="thread-icon-btn" id="btnJoinGroup" type="button" hidden aria-label="Unirme">Ôºã</button>
                <button class="thread-icon-btn" id="btnLeaveGroup" type="button" hidden aria-label="Salir">‚§¥</button>
              </div>
            </header>

            <div class="thread-tools" id="threadTools" hidden>
              <input class="input" id="threadSearch" type="text" placeholder="Buscar en esta conversacion..." />
              <label class="toggle-line">
                <input type="checkbox" id="threadSearchAttachments" />
                <span>Solo adjuntos</span>
              </label>
              <div class="thread-filter-info" id="threadFilterInfo"></div>
            </div>

            <div class="thread-messages" id="threadMessages"></div>

            <div class="thread-composer">
              <div class="composer-edit" id="composerEdit" hidden>
                <div class="composer-edit-text" id="composerEditText"></div>
                <button class="composer-mini-btn" id="btnCancelEdit" type="button" aria-label="Cancelar">√ó</button>
              </div>

              <div class="composer-reply" id="composerReply" hidden>
                <div class="composer-reply-text" id="composerReplyText"></div>
                <button class="composer-mini-btn" id="btnCancelReply" type="button" aria-label="Cancelar">√ó</button>
              </div>

              <div class="composer-preview" id="attachmentsPreview"></div>

              <div class="composer-row">
                <label class="composer-icon" for="fileInput" aria-label="Adjuntar">üìé</label>
                <textarea id="messageInput" rows="1" placeholder="Napisz wiadomosc..."></textarea>
                <button class="composer-icon" id="btnRecord" type="button" aria-label="Audio">üé§</button>
                <button class="composer-send" id="btnSend" type="button" aria-label="Enviar">‚û§</button>
              </div>

              <input id="fileInput" type="file" multiple hidden />
              <div class="composer-hint" id="recordHint"></div>
            </div>
          </div>
        </section>

        <aside class="card messages-info" id="messagesInfo" hidden>
          <header class="messages-info-head">
            <div class="messages-info-title">Detalles</div>
            <button class="thread-icon-btn" id="btnCloseInfoDrawer" type="button" aria-label="Cerrar">√ó</button>
          </header>

          <details class="messages-info-section" open>
            <summary>Resumen AI</summary>
            <div class="messages-info-content" id="infoBody"></div>
          </details>

          <details class="messages-info-section" open>
            <summary>Notas</summary>
            <div class="messages-info-content" id="infoActions"></div>
          </details>

          <details class="messages-info-section" open>
            <summary>Historia</summary>
            <div class="messages-info-content" id="pinnedBox"></div>
          </details>

          <details class="messages-info-section" open>
            <summary>Participantes</summary>
            <div class="messages-info-content" id="participantsBox"></div>
          </details>

          <details class="messages-info-section" open>
            <summary>Solicitudes</summary>
            <div class="messages-info-content" id="requestsBox"></div>
          </details>
        </aside>
      </div>
    </main>

    <div class="modalOverlay" id="modalNewChat">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Nuevo chat</div>
          <button class="btn-white-outline" id="closeNewChat" type="button">Cerrar</button>
        </div>
        <div class="modalBody">
          <div class="info-field">
            <label for="newChatInput">Buscar usuario</label>
            <input id="newChatInput" class="input" type="text" placeholder="@usuario o nombre" />
          </div>
          <div class="metaRow" style="margin-top: 10px">
            <button class="btn-yellow" id="btnSearchUser" type="button">Buscar</button>
            <span class="hintSmall" id="newChatHint"></span>
          </div>
          <div class="messages-list" id="newChatResults" style="margin-top: 12px"></div>
        </div>
      </div>
    </div>

    <div class="modalOverlay" id="modalNewGroup">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Crear grupo</div>
          <button class="btn-white-outline" id="closeNewGroup" type="button">Cerrar</button>
        </div>
        <div class="modalBody">
          <div class="info-field">
            <label for="groupName">Nombre del grupo</label>
            <input id="groupName" class="input" type="text" placeholder="Nombre" />
          </div>
          <div class="info-field" style="margin-top: 10px">
            <label for="groupDesc">Descripcion</label>
            <textarea id="groupDesc" class="input" rows="3" placeholder="Opcional"></textarea>
          </div>
          <div class="info-grid" style="margin-top: 10px">
            <div class="info-field">
              <label for="groupPublic">Visibilidad</label>
              <select id="groupPublic" class="select">
                <option value="public">Publico</option>
                <option value="private">Privado</option>
              </select>
            </div>
            <div class="info-field">
              <label for="groupJoinMode">Ingreso</label>
              <select id="groupJoinMode" class="select">
                <option value="open">Abierto</option>
                <option value="approval">Con aprobacion</option>
              </select>
            </div>
          </div>
          <div class="metaRow" style="margin-top: 12px">
            <button class="btn-yellow" id="btnCreateGroup" type="button">Crear</button>
            <span class="hintSmall" id="newGroupHint"></span>
          </div>
        </div>
      </div>
    </div>

    <div class="modalOverlay" id="modalReport">
      <div class="modalCard">
        <div class="modalHead">
          <div class="modalTitle">Reportar</div>
          <button class="btn-white-outline" id="closeReport" type="button">Cerrar</button>
        </div>
        <div class="modalBody">
          <div class="info-field">
            <label for="reportReason">Motivo</label>
            <select id="reportReason" class="select">
              <option value="spam">Spam</option>
              <option value="abuse">Abuso</option>
              <option value="scam">Estafa</option>
              <option value="other">Otro</option>
            </select>
          </div>
          <div class="info-field" style="margin-top: 10px">
            <label for="reportDetails">Detalles</label>
            <textarea id="reportDetails" class="input" rows="3" placeholder="Opcional"></textarea>
          </div>
          <div class="metaRow" style="margin-top: 12px">
            <button class="btn-yellow" id="btnSubmitReport" type="button">Enviar reporte</button>
            <span class="hintSmall" id="reportHint"></span>
          </div>
        </div>
      </div>
    </div>

    <script type="module" src="assets/js/pages/mensajes-page.js?v=20260222g"></script>
  </body>
</html>
